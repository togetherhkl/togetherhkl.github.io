<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Pytorch（四）转换与创建神经网络, Hkini, 学习, 生活, 工作, 记录">
    <meta name="description" content=" 

        
          
            
            总结
            文档总结
          
        
      
文档目录：


数据转换：主要讲解「transfo">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <title>Pytorch（四）转换与创建神经网络 | Hkini</title>
    <link rel="icon" type="image/png" href="/medias/logo.png">
    <link rel="stylesheet" type="text/css" href="/libs/prism/prism.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcdn.net/ajax/libs/prism/1.9.0/plugins/line-numbers/prism-line-numbers.css">
    
    <style>
        body{
            background-image: url(/medias/images/3.png);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hkini" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hkini</span>
                </a>
            </div>
            



<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-home moz-zoom" style="zoom: 0.6;"></i>
        
        <span>首页</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-graduation-cap moz-zoom" style="zoom: 0.6;"></i>
        
        <span>专业</span>
        
        <i class="fas fa-chevron-right moz-zoom" aria-hidden="true" style="zoom: 0.6;"></i>
        
      </a>
      
      <ul class="sub-nav menu-level-2 menus_item_child">
        
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%93%E4%B8%9A/%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA" class="waves-effect waves-light">
        
        <i class="fas fa-book moz-zoom" style="zoom: 0.6;"></i>
        
        <span>01基础理论</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%93%E4%B8%9A/%E6%A1%86%E6%9E%B6" class="waves-effect waves-light">
        
        <i class="fas fa-cubes moz-zoom" style="zoom: 0.6;"></i>
        
        <span>02框架</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%93%E4%B8%9A/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80" class="waves-effect waves-light">
        
        <i class="fas fa-code moz-zoom" style="zoom: 0.6;"></i>
        
        <span>03编程语言</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%93%E4%B8%9A/%E5%AE%9E%E8%B7%B5%E9%A1%B9%E7%9B%AE" class="waves-effect waves-light">
        
        <i class="fas fa-project-diagram moz-zoom" style="zoom: 0.6;"></i>
        
        <span>04实践项目</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%93%E4%B8%9A/%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95" class="waves-effect waves-light">
        
        <i class="fas fa-tools moz-zoom" style="zoom: 0.6;"></i>
        
        <span>05配置记录</span>
        
      </a>
      
    </li>
  

      </ul>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-briefcase moz-zoom" style="zoom: 0.6;"></i>
        
        <span>工作</span>
        
        <i class="fas fa-chevron-right moz-zoom" aria-hidden="true" style="zoom: 0.6;"></i>
        
      </a>
      
      <ul class="sub-nav menu-level-2 menus_item_child">
        
  
    <li class="menu-level-2">
      <a href="/categories/%E5%B7%A5%E4%BD%9C/%E9%A1%B9%E7%9B%AE" class="waves-effect waves-light">
        
        <i class="fas fa-tasks moz-zoom" style="zoom: 0.6;"></i>
        
        <span>01项目</span>
        
      </a>
      
    </li>
  

      </ul>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-icons moz-zoom" style="zoom: 0.6;"></i>
        
        <span>兴趣</span>
        
        <i class="fas fa-chevron-right moz-zoom" aria-hidden="true" style="zoom: 0.6;"></i>
        
      </a>
      
      <ul class="sub-nav menu-level-2 menus_item_child">
        
  
    <li class="menu-level-2">
      <a href="/categories/%E5%85%B4%E8%B6%A3/%E9%98%85%E8%AF%BB" class="waves-effect waves-light">
        
        <i class="fas fa-book-open moz-zoom" style="zoom: 0.6;"></i>
        
        <span>01阅读</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E5%85%B4%E8%B6%A3/%E7%85%A7%E7%89%87" class="waves-effect waves-light">
        
        <i class="fas fa-image moz-zoom" style="zoom: 0.6;"></i>
        
        <span>02照片</span>
        
      </a>
      
    </li>
  

      </ul>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-seedling moz-zoom" style="zoom: 0.6;"></i>
        
        <span>个人成长</span>
        
        <i class="fas fa-chevron-right moz-zoom" aria-hidden="true" style="zoom: 0.6;"></i>
        
      </a>
      
      <ul class="sub-nav menu-level-2 menus_item_child">
        
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/%E8%AE%A1%E5%88%92%E4%B8%8E%E6%80%BB%E7%BB%93" class="waves-effect waves-light">
        
        <i class="fas fa-tasks moz-zoom" style="zoom: 0.6;"></i>
        
        <span>01计划与总结</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/%E6%84%9F%E6%82%9F" class="waves-effect waves-light">
        
        <i class="fas fa-lightbulb moz-zoom" style="zoom: 0.6;"></i>
        
        <span>02感悟</span>
        
      </a>
      
    </li>
  

      </ul>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/" class="waves-effect waves-light">
        
        <i class="fas fa-list moz-zoom" style="zoom: 0.6;"></i>
        
        <span>整理</span>
        
        <i class="fas fa-chevron-right moz-zoom" aria-hidden="true" style="zoom: 0.6;"></i>
        
      </a>
      
      <ul class="sub-nav menu-level-2 menus_item_child">
        
  
    <li class="menu-level-2">
      <a href="/catstags" class="waves-effect waves-light">
        
        <i class="fas fa-bookmark moz-zoom" style="zoom: 0.6;"></i>
        
        <span>分类&标签</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/archives" class="waves-effect waves-light">
        
        <i class="fas fa-file-lines moz-zoom" style="zoom: 0.6;"></i>
        
        <span>归档</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/friends" class="waves-effect waves-light">
        
        <i class="fas fa-address-book moz-zoom" style="zoom: 0.6;"></i>
        
        <span>友链</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/contact" class="waves-effect waves-light">
        
        <i class="fas fa-comments moz-zoom" style="zoom: 0.6;"></i>
        
        <span>留言</span>
        
      </a>
      
    </li>
  
    <li class="menu-level-2">
      <a href="/about" class="waves-effect waves-light">
        
        <i class="fas fa-chart-bar moz-zoom" style="zoom: 0.6;"></i>
        
        <span>统计</span>
        
      </a>
      
    </li>
  

      </ul>
      
    </li>
  
    <li class="menu-level-1">
      <a href="/about" class="waves-effect waves-light">
        
        <i class="fas fa-user-circle moz-zoom" style="zoom: 0.6;"></i>
        
        <span>关于我</span>
        
      </a>
      
    </li>
  

  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search " title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hkini</div>
        <div class="logo-desc">
            
            一个记录生活、学习和工作的地方。记录生活中的点滴，分享学习的经验和工作中的思考。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-graduation-cap"></i>
			
			专业
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/categories/%E4%B8%93%E4%B8%9A/%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>01基础理论</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E4%B8%93%E4%B8%9A/%E6%A1%86%E6%9E%B6 " style="margin-left:75px">
				  
				   <i class="fa fas fa-cubes" style="position: absolute;left:50px" ></i>
			      
		          <span>02框架</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E4%B8%93%E4%B8%9A/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80 " style="margin-left:75px">
				  
				   <i class="fa fas fa-code" style="position: absolute;left:50px" ></i>
			      
		          <span>03编程语言</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E4%B8%93%E4%B8%9A/%E5%AE%9E%E8%B7%B5%E9%A1%B9%E7%9B%AE " style="margin-left:75px">
				  
				   <i class="fa fas fa-project-diagram" style="position: absolute;left:50px" ></i>
			      
		          <span>04实践项目</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E4%B8%93%E4%B8%9A/%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95 " style="margin-left:75px">
				  
				   <i class="fa fas fa-tools" style="position: absolute;left:50px" ></i>
			      
		          <span>05配置记录</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-briefcase"></i>
			
			工作
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/categories/%E5%B7%A5%E4%BD%9C/%E9%A1%B9%E7%9B%AE " style="margin-left:75px">
				  
				   <i class="fa fas fa-tasks" style="position: absolute;left:50px" ></i>
			      
		          <span>01项目</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-icons"></i>
			
			兴趣
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/categories/%E5%85%B4%E8%B6%A3/%E9%98%85%E8%AF%BB " style="margin-left:75px">
				  
				   <i class="fa fas fa-book-open" style="position: absolute;left:50px" ></i>
			      
		          <span>01阅读</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E5%85%B4%E8%B6%A3/%E7%85%A7%E7%89%87 " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>02照片</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-seedling"></i>
			
			个人成长
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/%E8%AE%A1%E5%88%92%E4%B8%8E%E6%80%BB%E7%BB%93 " style="margin-left:75px">
				  
				   <i class="fa fas fa-tasks" style="position: absolute;left:50px" ></i>
			      
		          <span>01计划与总结</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/%E6%84%9F%E6%82%9F " style="margin-left:75px">
				  
				   <i class="fa fas fa-lightbulb" style="position: absolute;left:50px" ></i>
			      
		          <span>02感悟</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			整理
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/catstags " style="margin-left:75px">
				  
				   <i class="fa fas fa-bookmark" style="position: absolute;left:50px" ></i>
			      
		          <span>分类&标签</span>
                  </a>
                </li>
              
                <li>

                  <a href="/archives " style="margin-left:75px">
				  
				   <i class="fa fas fa-file-lines" style="position: absolute;left:50px" ></i>
			      
		          <span>归档</span>
                  </a>
                </li>
              
                <li>

                  <a href="/friends " style="margin-left:75px">
				  
				   <i class="fa fas fa-address-book" style="position: absolute;left:50px" ></i>
			      
		          <span>友链</span>
                  </a>
                </li>
              
                <li>

                  <a href="/contact " style="margin-left:75px">
				  
				   <i class="fa fas fa-comments" style="position: absolute;left:50px" ></i>
			      
		          <span>留言</span>
                  </a>
                </li>
              
                <li>

                  <a href="/about " style="margin-left:75px">
				  
				   <i class="fa fas fa-chart-bar" style="position: absolute;left:50px" ></i>
			      
		          <span>统计</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于我
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Pytorch（四）转换与创建神经网络</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">
                                <span class="chip bg-color">人工智能</span>
                            </a>
                        
                            <a href="/tags/Pytorch/">
                                <span class="chip bg-color">Pytorch</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E4%B8%93%E4%B8%9A/" class="post-category">
                                专业
                            </a>
                        
                            <a href="/categories/%E4%B8%93%E4%B8%9A/%E6%A1%86%E6%9E%B6/" class="post-category">
                                框架
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-06-26
                </div>

                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-05-03
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    16 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <html><head></head><body><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>

        <div class="evoldown" id="文档总结" type="c">
          <span class="icon">
            <svg type="c" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m6.825 4.8749c1.8175-0.03033 2.3249 0.02869 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9798-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.019-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40204 2.4713 0.42016 0.661-0.00557 1.2079 0.02014 1.9275-0.21866 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08948-0.54803 0.07327-0.95095 0.0762-1.3975-0.00196-0.42752 0.01114-0.8053-0.05632-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17686-7.9441e-4 -0.35349-2.3937e-4 -0.53038-7.7934e-4z" fill="currentColor"></path><path d="m17.075 8.6749c1.8175-0.03034 2.3249 0.02868 2.25 2.0152 0.01495 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.05882 1.6262 0.20933 2.9457 1.5713 3.7017 0.98593 0.49528 1.6843 0.40205 2.4713 0.42017 0.66099-0.00556 1.2079 0.02015 1.9275-0.21865 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42839 0.0112-0.80698-0.05673-1.3089-0.24288-1.9391-1.9097-2.8158-3.663-2.7068-0.17688-7.9346e-4 -0.35351-2.388e-4 -0.5304-7.7896e-4z" fill="currentColor"></path><path d="m8.4749 15.525c1.8175-0.03033 2.3249 0.02868 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04172-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40203 2.4713 0.42016 0.66099-0.00557 1.2079 0.02014 1.9276-0.21866 1.051-0.35294 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42753 0.01113-0.80529-0.05633-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17688-7.9346e-4 -0.35351-2.4262e-4 -0.5304-7.8736e-4z" fill="currentColor"></path></svg>
            <p name="label">总结</p>
            <p name="id">文档总结</p>
          </span>
        </div>
      
<p>文档目录：</p>
<ol>
<li>
<p>数据转换：主要讲解「transforms」，涉及到的知识点有「匿名函数」，「对象自调用」</p>
</li>
<li>
<p>创建神经模型：涉及的知识点有「加速训练」「神经网络定义」「调用神经网络」「模型层」「模型参数」</p>
</li>
</ol>
<h1 id="1-数据转换transforms"><a class="markdownIt-Anchor" href="#1-数据转换transforms"></a> 1 数据转换（Transforms）</h1>

        <div class="evoldown" id="转换的目的" type="c">
          <span class="icon">
            <svg type="c" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m6.825 4.8749c1.8175-0.03033 2.3249 0.02869 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9798-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.019-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40204 2.4713 0.42016 0.661-0.00557 1.2079 0.02014 1.9275-0.21866 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08948-0.54803 0.07327-0.95095 0.0762-1.3975-0.00196-0.42752 0.01114-0.8053-0.05632-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17686-7.9441e-4 -0.35349-2.3937e-4 -0.53038-7.7934e-4z" fill="currentColor"></path><path d="m17.075 8.6749c1.8175-0.03034 2.3249 0.02868 2.25 2.0152 0.01495 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.05882 1.6262 0.20933 2.9457 1.5713 3.7017 0.98593 0.49528 1.6843 0.40205 2.4713 0.42017 0.66099-0.00556 1.2079 0.02015 1.9275-0.21865 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42839 0.0112-0.80698-0.05673-1.3089-0.24288-1.9391-1.9097-2.8158-3.663-2.7068-0.17688-7.9346e-4 -0.35351-2.388e-4 -0.5304-7.7896e-4z" fill="currentColor"></path><path d="m8.4749 15.525c1.8175-0.03033 2.3249 0.02868 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04172-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40203 2.4713 0.42016 0.66099-0.00557 1.2079 0.02014 1.9276-0.21866 1.051-0.35294 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42753 0.01113-0.80529-0.05633-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17688-7.9346e-4 -0.35351-2.4262e-4 -0.5304-7.8736e-4z" fill="currentColor"></path></svg>
            <p name="label">说明</p>
            <p name="id">转换的目的</p>
          </span>
        </div>
      
<p>数据并不总是以「训练机器学习算法」所需的最终处理形式出现。使用转换（transforms）来执行数据的「一些操作」，使其适合训练。</p>

        <div class="evoldown" id="TorchVision中的转换" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">TorchVision中的转换</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="c" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m6.825 4.8749c1.8175-0.03033 2.3249 0.02869 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9798-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.019-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40204 2.4713 0.42016 0.661-0.00557 1.2079 0.02014 1.9275-0.21866 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08948-0.54803 0.07327-0.95095 0.0762-1.3975-0.00196-0.42752 0.01114-0.8053-0.05632-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17686-7.9441e-4 -0.35349-2.3937e-4 -0.53038-7.7934e-4z" fill="currentColor"></path><path d="m17.075 8.6749c1.8175-0.03034 2.3249 0.02868 2.25 2.0152 0.01495 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.05882 1.6262 0.20933 2.9457 1.5713 3.7017 0.98593 0.49528 1.6843 0.40205 2.4713 0.42017 0.66099-0.00556 1.2079 0.02015 1.9275-0.21865 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42839 0.0112-0.80698-0.05673-1.3089-0.24288-1.9391-1.9097-2.8158-3.663-2.7068-0.17688-7.9346e-4 -0.35351-2.388e-4 -0.5304-7.7896e-4z" fill="currentColor"></path><path d="m8.4749 15.525c1.8175-0.03033 2.3249 0.02868 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04172-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40203 2.4713 0.42016 0.66099-0.00557 1.2079 0.02014 1.9276-0.21866 1.051-0.35294 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42753 0.01113-0.80529-0.05633-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17688-7.9346e-4 -0.35351-2.4262e-4 -0.5304-7.8736e-4z" fill="currentColor"></path></svg>
            <p name="id">转换的目的</p>
          </span>
        </div>
      
<p>所有TorchVision数据集都有两个参数：<br>
<code>transform</code>用于修改特征。<br>
<code>target_transform</code>用于修改标签，它们接受包含转换逻辑的可调用对象。</p>

        <div class="evoldown" id="FashionMNIST转换" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">FashionMNIST转换</p>
          </span>
        </div>
      
<p>FashionMNIST的特征数据以PIL图像格式存在，标签是整数。为了训练，需要将「特征」转换为使用的的「张量形式」，并将标签转换为<code>one-hot</code>编码的张量。使用<code>ToTensor</code>和<code>Lambda</code>实现这些转换。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensor<span class="token punctuation">,</span> Lambda
ds <span class="token operator">=</span> datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>
    root<span class="token operator">=</span><span class="token string">"data"</span><span class="token punctuation">,</span>
    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    transform<span class="token operator">=</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    target_transform<span class="token operator">=</span>Lambda<span class="token punctuation">(</span><span class="token keyword">lambda</span> y<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scatter_<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
    target_transform参数用于对目标（标签）进行转换。
    lamdba:定义一个匿名函数，y是函数的参数
    torch.zeros(10, dtype=torch.float)创建一个长度为10，数据类型为float的零向量
    .scatter_(0, torch.tensor(y), value=1)就地操作，在零向量的y索引的位置上的值设置为1，设置一个one-hot编码
    '''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="匿名函数" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">匿名函数</p>
          </span>
        </div>
      
<p>匿名函数，通常在Python中通过<code>lambda</code>关键字定义，是一种没有名称的简单函数。它们通常用于执行简短的、一次性的任务，特别是在需要函数对象的地方，但又不想使用完整的函数定义语法，是一个非常有用的工具，它提供了一种快速定义简单函数的方式，使得代码更加简洁，增加了编程的灵活性。</p>
<p><strong>匿名函数的主要属性和特点包括：</strong></p>
<ol>
<li><strong>没有名称</strong>：正如“匿名”所暗示的，这类函数没有名称。</li>
<li><strong>简洁的定义</strong>：通常只有一行代码，适用于简单的逻辑。</li>
<li><strong>自动返回值</strong>：<code>lambda</code>表达式的结果自动成为返回值，无需显式使用<code>return</code>语句。</li>
<li><strong>可接受任意数量的参数</strong>：但只能有一个表达式。</li>
</ol>
<p><strong>创造「匿名函数」的目的</strong>：</p>
<ul>
<li><strong>简化代码</strong>：对于简单的函数，使用<code>lambda</code>可以避免定义标准的函数，从而减少代码量。</li>
<li><strong>功能性编程</strong>：<code>lambda</code>表达式支持函数式编程范式，在处理高阶函数和操作（如<code>map</code>、<code>filter</code>、<code>sorted</code>等）时非常有用。</li>
</ul>
<p><strong>没有这个概念「匿名函数」有什么影响</strong>：</p>
<ul>
<li><strong>代码冗长</strong>：对于需要传递简单函数作为参数的场合，如果没有匿名函数，就需要定义标准的函数。这会使得代码变得更加冗长，特别是当这个函数只需要在一个地方使用时。</li>
<li><strong>减少灵活性</strong>：在某些情况下，使用匿名函数可以使代码更加灵活和简洁。没有匿名函数，某些编程模式（如即时使用的小函数作为参数传递）会更加复杂。</li>
<li><strong>降低可读性</strong>：虽然过度使用<code>lambda</code>可能会降低代码的可读性，但在适当的场合使用它们可以使代码更加直观。没有<code>lambda</code>表达式，对于那些最适合使用匿名函数的场景，代码可能会变得更难理解。</li>
</ul>

        <div class="evoldown" id="快速决策" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">快速决策</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">匿名函数</p>
          </span>
        </div>
      
<p>想象你在一个快餐店，需要快速决定每个人的饮料。你可以为每个人设置一个简单的规则（匿名函数）：如果某人喜欢甜的，就选择可乐；如果不喜欢甜的，就选择无糖的绿茶。</p>
<p>在这个例子中，「决策规则」就像一个匿名函数，它根据一个「输入」（是否喜欢甜的）来快速决定「输出」（选择哪种饮料）。虽然这不是编程中的直接应用，但它展示了匿名函数概念的一个类比——根据输入快速产生输出，而不需要为这个决策过程命名或详细定义。</p>

        <div class="evoldown" id="列表排顺" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">列表排顺</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">匿名函数</p>
          </span>
        </div>
      
<p>在Python中，我们经常需要根据列表中元素的「某个属性」或「值」来对列表进行排序。使用<code>lambda</code>表达式，我们可以轻松地定义排序的关键字。<br>
在这个例子中，<code>lambda x: x[1]</code>是一个匿名函数，它接受一个参数<code>x</code>（在这里是列表中的一个元组）并返回「元组」的第二个元素作为排序的依据。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 根据元组的第二个元素进行排序</span>
tuples <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'banana'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'apple'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'cherry'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
tuples<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tuples<span class="token punctuation">)</span>  <span class="token comment"># 输出: [(2, 'apple'), (1, 'banana'), (3, 'cherry')]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="filter()函数" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">filter()函数</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">匿名函数</p>
          </span>
        </div>
      
<p><code>filter()</code>函数用于过滤序列，过滤掉不符合条件的元素，返回一个迭代器。使用<code>lambda</code>表达式，我们可以定义过滤的条件。<br>
这里，<code>lambda x: x % 2 == 0</code>是一个匿名函数，它接受一个参数<code>x</code>并检查<code>x</code>是否为偶数。<code>filter()</code>函数使用这个匿名函数来决定哪些元素应该被包含在结果列表中。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 过滤出列表中的偶数</span>
numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
even_numbers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>even_numbers<span class="token punctuation">)</span>  <span class="token comment"># 输出: [2, 4, 6, 8]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="对象自调用" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">对象自调用</p>
          </span>
        </div>
      
<p>Python中的「对象自调用」概念指的是一个对象可以表现得像一个函数，即这个对象可以被直接调用。这是通过在类中定义<code>__call__</code>魔术方法（magic method）来实现的。对象自调用的能力使得对象在调用时可以执行特定的操作。</p>
<p><strong>属性：</strong></p>
<ul>
<li><strong><code>__call__</code>方法</strong>：这是判断一个对象是否支持自调用的主要依据。如果一个对象的类中定义了<code>__call__</code>方法，那么这个对象就可以被直接调用。</li>
</ul>
<p><strong>「对象自调用」解决的问题：</strong></p>
<ul>
<li><strong>灵活性增强</strong>：对象自调用提供了一种使对象行为更加灵活的方式。它允许对象在保持状态的同时，还能够像函数一样被调用，从而在对象和函数之间提供了一种灵活的转换机制。</li>
<li><strong>接口统一</strong>：在某些设计模式中，如命令模式，可以通过对象自调用的方式来统一不同操作的接口。这样，无论是直接执行一个函数还是通过对象来执行，都可以有相同的调用方式。</li>
</ul>
<p><strong>没有「对象自调用」的影响：</strong></p>
<ul>
<li><strong>减少灵活性</strong>：没有对象自调用的概念，对象和函数之间的界限会更加明确，这在某些情况下减少了编程的灵活性。对象将不能直接作为函数来调用，可能需要更多的代码来实现相同的功能。</li>
<li><strong>设计模式限制</strong>：某些设计模式的实现会受到限制。例如，在需要将对象作为可调用实体传递的场景中，如果没有对象自调用的概念，就需要额外的机制来模拟这一行为，增加了实现的复杂度。</li>
</ul>

        <div class="evoldown" id="智能音箱" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">智能音箱</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">对象自调用</p>
          </span>
        </div>
      
<p>想象一下，你有一个智能音箱，比如一个小爱同学或者天猫精灵。这个智能音箱就像是一个具有「对象自调用」能力的对象。我们可以把它想象成一个Python对象，这个对象有一个<code>__call__</code>方法，允许你直接对它说话（调用它），然后它会根据你的命令「执行相应的操作」。当对智能音箱发出命令时，就像在调用对象的<code>__call__</code>方法，根据你的「命令（输入参数）」，它会「执行相应的操作」并给出反馈。</p>

        <div class="evoldown" id="计数类器" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">计数类器</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">对象自调用</p>
          </span>
        </div>
      
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Counter</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> increment<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>count <span class="token operator">+=</span> increment
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>count

counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出: 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出: 11</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="2-创建神经网络"><a class="markdownIt-Anchor" href="#2-创建神经网络"></a> 2 创建神经网络</h1>
<h2 id="21-获取训练的设备"><a class="markdownIt-Anchor" href="#21-获取训练的设备"></a> 2.1 获取训练的设备</h2>

        <div class="evoldown" id="加速训练" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">加速训练</p>
          </span>
        </div>
      
<p>可以使用硬件如GPU，MPS来加速模型的训练。</p>

        <div class="evoldown" id="获取代码" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">获取代码</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">加速训练</p>
          </span>
        </div>
      
<p>可以使用<code>torch.cuda</code> 或者`torch.backends.mps来判断硬件设备是否可用。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">device <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token string">"cuda"</span>
    <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token string">"mps"</span>
    <span class="token keyword">if</span> torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>mps<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token string">"cpu"</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Using </span><span class="token interpolation"><span class="token punctuation">{</span>device<span class="token punctuation">}</span></span><span class="token string"> device"</span></span><span class="token punctuation">)</span>
<span class="token comment"># Using cuda device</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="22-定义神经网络"><a class="markdownIt-Anchor" href="#22-定义神经网络"></a> 2.2 定义神经网络</h2>

        <div class="evoldown" id="神经网络定义" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">神经网络定义</p>
          </span>
        </div>
      
<p>通过继承nn.Module来定义神经网络，并在__init__方法中初始化神经网络层。每一个nn.Module的子类都在forward方法中实现了对「输入数据」的操作。</p>

        <div class="evoldown" id="定义代码" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">定义代码</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">神经网络定义</p>
          </span>
        </div>
      
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">NueralNetwork</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#初始化神经网络层</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#调用父类的初始化方法</span>
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#将图像张量展平</span>
        self<span class="token punctuation">.</span>linear_relu_stack <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token comment">#定义一个包含三个全连接层的神经网络</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#输入层，参数分别为输入特征的形状和输出特征的形状</span>
            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#激活函数</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#隐藏层，参数分别为输入特征的形状和输出特征的形状</span>
            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment">#展平图像张量</span>
        logits <span class="token operator">=</span> self<span class="token punctuation">.</span>linear_relu_stack<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment">#将张量传递给神经网络</span>
        <span class="token keyword">return</span> logits<span class="token comment">#返回输出</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="调用神经网络" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">调用神经网络</p>
          </span>
        </div>
      
<p>在定义好神经网络过后，通过实例化神经网络，并传递需要的数据来获取预测值。</p>

        <div class="evoldown" id="实例化" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">实例化</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">调用神经网络</p>
          </span>
        </div>
      
<pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> NueralNetwork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span>
<span class="token string">''</span>'
NueralNetwork<span class="token punctuation">(</span>
  <span class="token punctuation">(</span>flatten<span class="token punctuation">)</span><span class="token punctuation">:</span> Flatten<span class="token punctuation">(</span>start_dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> end_dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>linear_relu_stack<span class="token punctuation">)</span><span class="token punctuation">:</span> Sequential<span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">784</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="传递数据" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">传递数据</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">调用神经网络</p>
          </span>
        </div>
      
<p>使用模型，将「输入数据」传递给它。将会执行模型的forward方法以及一些后台操作。但不要直接调用model.forward()。<br>
调用模型对输入数据执行操作，将返回一个二维张量，其中维度0（dim=0）对应于每个类别的10个原始预测值，维度1（dim=1）对应于每个输出的单独值。我们通过传递给nn.Softmax模块的一个实例来获得预测概率。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">X <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token comment">#生成一个随机张量,参数分别为张量的形状和设备，形状为1*28*28的张量</span>
logits <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token comment">#将张量传递给神经网络</span>
pred_probab <span class="token operator">=</span> nn<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>logits<span class="token punctuation">)</span><span class="token comment">#将预测值传递给Softmax函数，dim=1表示计算每行的softmax,(logits)是「对象自调用」</span>
y_pred <span class="token operator">=</span> pred_probab<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#返回每行中最大值的索引，若参数为0，则返回每列中最大值的索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Predicted class: </span><span class="token interpolation"><span class="token punctuation">{</span>y_pred<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token comment">#打印预测的类别</span>
<span class="token triple-quoted-string string">'''
Predicted class: tensor([1], device='cuda:0')
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="23-模型层"><a class="markdownIt-Anchor" href="#23-模型层"></a> 2.3 模型层</h2>

        <div class="evoldown" id="模型层" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>模型层「layers」是指在定义神经网络时，编写在<code>__init__()</code>函数下的内容。</p>

        <div class="evoldown" id="模型层讲解 模型层" type="c">
          <span class="icon">
            <svg type="c" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m6.825 4.8749c1.8175-0.03033 2.3249 0.02869 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9798-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.019-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40204 2.4713 0.42016 0.661-0.00557 1.2079 0.02014 1.9275-0.21866 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08948-0.54803 0.07327-0.95095 0.0762-1.3975-0.00196-0.42752 0.01114-0.8053-0.05632-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17686-7.9441e-4 -0.35349-2.3937e-4 -0.53038-7.7934e-4z" fill="currentColor"></path><path d="m17.075 8.6749c1.8175-0.03034 2.3249 0.02868 2.25 2.0152 0.01495 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.05882 1.6262 0.20933 2.9457 1.5713 3.7017 0.98593 0.49528 1.6843 0.40205 2.4713 0.42017 0.66099-0.00556 1.2079 0.02015 1.9275-0.21865 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42839 0.0112-0.80698-0.05673-1.3089-0.24288-1.9391-1.9097-2.8158-3.663-2.7068-0.17688-7.9346e-4 -0.35351-2.388e-4 -0.5304-7.7896e-4z" fill="currentColor"></path><path d="m8.4749 15.525c1.8175-0.03033 2.3249 0.02868 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04172-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40203 2.4713 0.42016 0.66099-0.00557 1.2079 0.02014 1.9276-0.21866 1.051-0.35294 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42753 0.01113-0.80529-0.05633-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17688-7.9346e-4 -0.35351-2.4262e-4 -0.5304-7.8736e-4z" fill="currentColor"></path></svg>
            <p name="label">说明</p>
            <p name="id">模型层讲解 模型层</p>
          </span>
        </div>
      
<p>接下里将分解FashionMNIST模型中的层。为了讲解「模型层」，将取一个包含3张28x28大小图像的样本小批量，并观察当将其通过网络传递时会发生什么。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">input_image <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token comment">#随机生成一个3*28*28的张量</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>input_image<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#打印张量的形状</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>input_image<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">#打印张量的形状</span>
<span class="token triple-quoted-string string">'''
torch.Size([3, 28, 28])
torch.Size([3, 28, 28])
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="nn.Flatten" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">nn.Flatten</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>初始化Flatten层后，可以通过调用它来展平3D张量。将3<em>28</em>28图像转换成一个连续的784像素值的数组。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">flatten <span class="token operator">=</span> nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#实例化Flatten层</span>
flat_image <span class="token operator">=</span> flatten<span class="token punctuation">(</span>input_image<span class="token punctuation">)</span><span class="token comment">#将张量传递给Flatten层</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flat_image<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#打印张量的形状</span>
<span class="token triple-quoted-string string">'''
torch.Size([3, 784])
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="nn.Linear" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">nn.Linear</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>Linear层使用一种称为「权重」的内部张量，以及一种称为「偏置」的内部张量，对输入张量进行「线性变换（ linear transformation）」。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">layer1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token comment">#in_features表示输入特征的形状，out_features表示输出特征的形状</span>
hidden1 <span class="token operator">=</span> layer1<span class="token punctuation">(</span>flat_image<span class="token punctuation">)</span><span class="token comment">#将张量传递给Linear层</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>hidden1<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#打印张量的形状</span>
<span class="token triple-quoted-string string">'''
torch.Size([3, 20])
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="nn.ReLU" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">nn.ReLU</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>「非线性激活函数」对模型的「输人」和「输出」创建「复杂的映射」。在线性变换后，引入非线性激活函数，帮助神经网络学习各种规律。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Before ReLU:</span><span class="token interpolation"><span class="token punctuation">{</span>hidden1<span class="token punctuation">}</span></span><span class="token string">\n\n"</span></span><span class="token punctuation">)</span><span class="token comment">#打印隐藏层的输出</span>
hidden1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>hidden1<span class="token punctuation">)</span><span class="token comment">#将隐藏层的输出传递给ReLU激活函数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"After ReLU: </span><span class="token interpolation"><span class="token punctuation">{</span>hidden1<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token comment">#打印隐藏层的输出</span>
<span class="token triple-quoted-string string">'''
Before ReLU:tensor([[-0.6295, -0.0362, -0.1422,  0.1866, -0.0955,  0.1350, -0.0350, -0.0746,
         -0.3552,  0.2612, -0.1565, -0.1210, -0.1081,  0.0425,  0.3023,  0.0560,
          0.2418, -0.0035,  0.9525,  0.1108],
        [-0.6520, -0.3238, -0.0208,  0.0317,  0.0194,  0.5342, -0.2582, -0.3136,
         -0.3851,  0.2427, -0.0782, -0.3597, -0.2151, -0.1793, -0.0808, -0.1593,
          0.4785, -0.0835,  0.9555, -0.1394],
        [-0.9776, -0.3067, -0.1160, -0.0596,  0.1393,  0.2737,  0.1556,  0.0434,
         -0.6965,  0.4378, -0.2360, -0.1565,  0.3842, -0.2784,  0.3218, -0.0107,
          0.5351, -0.2072,  0.8570, -0.1982]], grad_fn=&lt;AddmmBackward0&gt;)


After ReLU: tensor([[0.0000, 0.0000, 0.0000, 0.1866, 0.0000, 0.1350, 0.0000, 0.0000, 0.0000,
         0.2612, 0.0000, 0.0000, 0.0000, 0.0425, 0.3023, 0.0560, 0.2418, 0.0000,
         0.9525, 0.1108],
        [0.0000, 0.0000, 0.0000, 0.0317, 0.0194, 0.5342, 0.0000, 0.0000, 0.0000,
         0.2427, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.4785, 0.0000,
         0.9555, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.1393, 0.2737, 0.1556, 0.0434, 0.0000,
         0.4378, 0.0000, 0.0000, 0.3842, 0.0000, 0.3218, 0.0000, 0.5351, 0.0000,
         0.8570, 0.0000]], grad_fn=&lt;ReluBackward0&gt;)
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="nn.Sequential" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">nn.Sequential</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>nn.Sequential是一个有序的容器，数据按照在函数中传递给它的顺序通过所有的模块。可以使用nn.Sequential容器快速组装网络，例如seq_modules。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">seq_modules <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
    flatten<span class="token punctuation">,</span>
    layer1<span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
input_image <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token comment">#随机生成一个3*28*28的张量</span>
logits <span class="token operator">=</span> seq_modules<span class="token punctuation">(</span>input_image<span class="token punctuation">)</span><span class="token comment">#将张量传递给Sequential容器</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        <div class="evoldown" id="nn.Softmax" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">nn.Softmax</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型层</p>
          </span>
        </div>
      
<p>神经网络的最后一个线性层返回「原始预测值」，这些值被称为「logits」，[-infty, infty]中的原始值传递给nn.Softmax模块，将其转换为[0, 1]范围内的值。dim参数表示沿着哪个轴计算softmax。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">softmax <span class="token operator">=</span> nn<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#实例化Softmax函数</span>
pred_probab <span class="token operator">=</span> softmax<span class="token punctuation">(</span>logits<span class="token punctuation">)</span><span class="token comment">#将logits传递给Softmax函数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="24-模型参数"><a class="markdownIt-Anchor" href="#24-模型参数"></a> 2.4 模型参数</h2>

        <div class="evoldown" id="模型参数" type="d">
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型参数</p>
          </span>
        </div>
      
<p>「神经网络」内部的许多「层」是「参数化」的，在训练过程中能够优化相关「权重」和「偏置」。继承nn.Module的类会自动「模型对象」内部的定义的参数，可以使用模型的parameters()或named_parameters()方法使所有参数可访问。</p>

        <div class="evoldown" id="打印参数例子" type="e">
          <span class="icon">
            <svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>
            <p name="id">打印参数例子</p>
          </span>
          <span class="link-icon ml-[0.5em] mr-[0.25em]">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.9411764705882353em" height="0.9411764705882353em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class="untouchable"><path d="m9.5652 14.45 0.72891-2.0026c-0.651 0.00713-1.3027 0.00104-1.9532 0.00179-1.0991-0.02908-3.0336 0.08306-3.605-1.0524-0.28828-0.61588-0.2054-1.3226-0.22136-1.9833 0.00663-0.74044-0.05553-1.6362 0.5758-2.1558 0.70637-0.5555 1.7411-0.56129 2.6027-0.59834 0.743-0.015 1.4884-0.00764 2.2315-0.00868 0.68471 0.01536 1.6274-0.01783 2.4184 0.16762l0.68711-1.8879c-0.0146-0.003965-0.0287-0.00841-0.0435-0.01227-0.94653-0.24905-1.9355-0.25901-2.9083-0.26688-0.78352-1.3008e-4 -1.5692-0.0063751-2.3527 0.006805-1.2709 0.027555-2.6299 0.13739-3.6978 0.89566-1.6654 1.2031-1.53 2.9573-1.5068 4.79-0.0012251 1.7732 0.89765 3.2159 2.626 3.7562 0.80589 0.26191 1.6615 0.32018 2.5036 0.34101 0.6376 0.01106 1.2763 0.01096 1.9146 0.00915z" fill="currentColor"></path><path d="m14.589 9.125h1.3099c0.02865-0.88714-0.11774-1.6826-0.45594-2.3461l-0.85392 2.3461z" fill="currentColor"></path><path d="m15.587 12.025h-2.0527l-0.80604 2.2146c1.2326-0.27362 2.3169-0.88582 2.8588-2.2146z" fill="currentColor"></path><path d="m8.394 12.025h2.0538l0.82406-2.2641c-1.2457 0.2734-2.3327 0.8901-2.8779 2.2641z" fill="currentColor"></path><path d="m8.5566 17.221 0.83571-2.2961h-1.2914c-0.025394 0.86685 0.12295 1.645 0.45565 2.2961z" fill="currentColor"></path><path d="m21.485 14.399c7e-4 -0.67593 0.0063-1.3662-0.1779-2.0223-0.58881-2.115-2.5706-2.7532-4.5608-2.8041-0.76964-0.031175-1.5416-0.02264-2.3121-0.022365l-0.72832 2.0011c0.38557-0.00297 0.77131 7.6e-4 1.1559-0.00173 1.1244 0.02284 2.8396-0.10221 3.8152 0.44616 0.82512 0.45526 0.81194 1.4036 0.80798 2.2308-0.01538 0.64171 0.05949 1.3145-0.1601 1.93-0.39418 1.0145-1.651 1.1102-2.5915 1.1694-0.7426 0.03331-1.4884 0.0209-2.2315 0.02365-0.81334-0.01641-1.9395 0.04306-2.8448-0.16914l-0.68792 1.89c0.014845 0.00401 0.02915 0.0085 0.044115 0.0124 0.94522 0.24688 1.9316 0.25913 2.9027 0.2657 0.83456-2.2e-4 1.6713 0.00786 2.5057-0.00999 2.0286-0.02122 4.1491-0.51576 4.8438-2.6752 0.2358-0.7292 0.22-1.5067 0.2196-2.2644z" fill="currentColor"></path><path d="m14.979 6.7378c0.17824-0.52033 0.90905-2.4486 1.0626-2.9514 0.05601-0.19527 0.10768-0.39984 0.08232-0.60408-0.03096-0.33264-0.36035-0.4603-0.63671-0.55464-0.20794-0.070665-0.41593-0.17228-0.63943-0.174-0.33751 0.005805-0.52152 0.33878-0.64452 0.61072-1.4256 3.8005-4.7612 13.07-6.1617 16.891-0.10636 0.34-0.29285 0.7891-0.06874 1.1109 0.1296 0.1673 0.34386 0.232 0.53431 0.3042 0.30778 0.1107 0.70325 0.3075 0.98251 0.0365 0.14514-0.1339 0.23561-0.315 0.31595-0.4926 0.10005-0.2274 0.1811-0.4632 0.26694-0.6962 0.4854-1.3337 4.3257-11.885 4.9065-13.481z" fill="currentColor"></path></svg>
          </span>
          
          <span class="icon">
            <svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>
            <p name="id">模型参数</p>
          </span>
        </div>
      
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Model structure: "</span><span class="token punctuation">,</span> model<span class="token punctuation">,</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span><span class="token comment">#打印模型的结构</span>
<span class="token keyword">for</span> name<span class="token punctuation">,</span> param <span class="token keyword">in</span> model<span class="token punctuation">.</span>named_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#遍历模型的参数</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Layer: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> | Size: </span><span class="token interpolation"><span class="token punctuation">{</span>param<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | Values: </span><span class="token interpolation"><span class="token punctuation">{</span>param<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">2]</span><span class="token punctuation">}</span></span><span class="token string"> \n"</span></span><span class="token punctuation">)</span><span class="token comment">#打印参数的名称、形状和前两个值</span>
<span class="token triple-quoted-string string">'''
Model structure:  NueralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)
Layer: linear_relu_stack.0.weight | Size: torch.Size([512, 784]) | Values: tensor([[ 1.2033e-02, -3.3190e-02,  3.5117e-02,  ..., -3.1082e-04,
          3.1766e-02,  8.9217e-05],
        [-2.2151e-02,  8.2360e-03,  2.6249e-02,  ...,  1.1201e-02,
          1.0973e-02,  3.0528e-02]], device='cuda:0', grad_fn=&lt;SliceBackward0&gt;)

Layer: linear_relu_stack.0.bias | Size: torch.Size([512]) | Values: tensor([0.0314, 0.0233], device='cuda:0', grad_fn=&lt;SliceBackward0&gt;)       

Layer: linear_relu_stack.2.weight | Size: torch.Size([512, 512]) | Values: tensor([[-0.0299, -0.0194,  0.0357,  ..., -0.0063, -0.0406,  0.0399],
        [ 0.0007,  0.0034,  0.0072,  ...,  0.0176, -0.0431,  0.0424]],
       device='cuda:0', grad_fn=&lt;SliceBackward0&gt;)

Layer: linear_relu_stack.2.bias | Size: torch.Size([512]) | Values: tensor([0.0287, 0.0206], device='cuda:0', grad_fn=&lt;SliceBackward0&gt;)       

Layer: linear_relu_stack.4.weight | Size: torch.Size([10, 512]) | Values: tensor([[ 0.0293,  0.0368, -0.0042,  ..., -0.0112, -0.0114, -0.0138],
        [ 0.0157,  0.0046, -0.0023,  ..., -0.0414, -0.0390, -0.0082]],
       device='cuda:0', grad_fn=&lt;SliceBackward0&gt;)

Layer: linear_relu_stack.4.bias | Size: torch.Size([10]) | Values: tensor([0.0046, 0.0029], device='cuda:0', grad_fn=&lt;SliceBackward0&gt;) 
'''</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></body></html>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Hkini</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://www.hkini.top/posts/48354.html">https://www.hkini.top/posts/48354.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Hkini</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">
                                    <span class="chip bg-color">人工智能</span>
                                </a>
                            
                                <a href="/tags/Pytorch/">
                                    <span class="chip bg-color">Pytorch</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,douban" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid="></script>
    <div class="addthis_inline_share_toolbox"></div>
    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'AcWiopK3pHt4imczk7wvUFZZ-gzGzoHsz',
        appKey: 'UxlKcVndM3aSrEzt9vM0ul6L',
        serverURLs: 'https://acwiopk3.lc-cn-n1-shared.com',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '欢迎评论'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/48940.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.png" class="responsive-img" alt="Pytorch（五）自动微分">
                        
                        <span class="card-title">Pytorch（五）自动微分</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-06-28
                        </span>
                        
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E4%B8%93%E4%B8%9A/" class="post-category">
                                    专业
                                </a>
                            
                            <a href="/categories/%E4%B8%93%E4%B8%9A/%E6%A1%86%E6%9E%B6/" class="post-category">
                                    框架
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">
                        <span class="chip bg-color">人工智能</span>
                    </a>
                    
                    <a href="/tags/Pytorch/">
                        <span class="chip bg-color">Pytorch</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/43278.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.png" class="responsive-img" alt="Pytorch（三）数据集与数据加载器">
                        
                        <span class="card-title">Pytorch（三）数据集与数据加载器</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-06-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E4%B8%93%E4%B8%9A/" class="post-category">
                                    专业
                                </a>
                            
                            <a href="/categories/%E4%B8%93%E4%B8%9A/%E6%A1%86%E6%9E%B6/" class="post-category">
                                    框架
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">
                        <span class="chip bg-color">人工智能</span>
                    </a>
                    
                    <a href="/tags/Pytorch/">
                        <span class="chip bg-color">Pytorch</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: Hkini<br />'
            + '文章作者: Hkini<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('2'),
            // headingSelector: 'h1, h2, h3, h4, h5, h6'
            headingSelector: 'none',
        });
        var tocList = $('<ol>', { class: 'toc-list' }); // 创建顶层 <ol> 容器
        var currentLevel = 1; // 当前层级
        var parentStack = [tocList]; // 用于存储父级 <ol> 的栈

        $('#articleContent').find('h1, h2, h3, h4, h5, h6').each(function () {
            var $heading = $(this);
            var headingText = $heading.text();
            var level = parseInt($heading[0].tagName[1], 10); // 获取当前标题的层级，例如 h1 -> 1, h2 -> 2
            
            // var tocList = $('<ol>', { class: 'toc-list ' }); // 创建 <ol> 容器
            var tocListItem = $('<li>', { class: 'toc-list-item' }); // 创建 <li> 容器

            var tocItem = $('<a>', { 
                href: '#' + $heading.attr('id'), 
                class: 'toc-link' // 添加 class="toc-link"
            }).text(headingText); // 创建 <a> 标签

            // 创建箭头 SVG
            var arrowSvg = `<svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" fill="none" version="1.1" viewBox="0 0 24 24" class="h-[0.96em] w-[0.96em] text-foreground" style="transition: transform 233ms cubic-bezier(0.42, 0, 0.24, 1); transform: rotate(0deg);"><path d="m18.707 9.7075 4e-4 -3.75e-4q0.1407-0.14065 0.2168-0.32442 0.0761-0.18377 0.0761-0.38268t-0.0761-0.38268q-0.0761-0.18377-0.2168-0.32442-0.1406-0.14065-0.3244-0.21677-0.1838-0.07612-0.3827-0.07612t-0.3827 0.076121q-0.1838 0.07612-0.3244 0.21677l-4e-4 3.75e-4 -5.2925 5.2925-5.2929-5.2929q-0.14065-0.14065-0.32442-0.21677-0.18377-0.07612-0.38268-0.07612t-0.38268 0.07612q-0.18377 0.076121-0.32442 0.21677t-0.21677 0.32442q-0.07612 0.18377-0.07612 0.38268t0.07612 0.38268q0.076121 0.18377 0.21677 0.32442l6 6q0.14066 0.14065 0.32443 0.21677 0.18377 0.07612 0.38268 0.07612t0.38268-0.07612q0.18377-0.07612 0.32443-0.21677l5.9996-5.9996z" fill="currentColor" fill-rule="evenodd"></path></svg>`;

            // 包裹 <a> 标签的 <div>
            var tocItemWrapper = $('<div>', { 
                class: 'toc-item-wrapper' // 添加 class="toc-item-wrapper"
            }).append(tocItem).append(arrowSvg); // 将 <a> 添加到 <div>

            // 为 TOC 项添加相应的缩进
            // tocItem.css('padding-left', (level - 1) * 20 + 'px');

            // 将 <a> 添加到 <li>
            tocListItem.append(tocItemWrapper);
             // 如果当前标题层级比上一个标题层级高，创建新的嵌套 <ol>
                if (level > currentLevel) {
                var nestedList = $('<ol>', { class: 'toc-list' }); // 创建嵌套的 <ol>
                parentStack[parentStack.length - 1].children('li:last').append(nestedList); // 将嵌套 <ol> 添加到父级 <li>
                parentStack.push(nestedList); // 将嵌套 <ol> 压入栈
            } 
            // 如果当前标题层级比上一个标题层级低，回退到正确的父级
            else if (level < currentLevel) {
                while (level < currentLevel) {
                    parentStack.pop(); // 弹出栈顶，回退到上一级
                    currentLevel--;
                }
            }

            // 将当前 <li> 添加到当前层级的 <ol>
            parentStack[parentStack.length - 1].append(tocListItem);
            currentLevel = level; // 更新当前层级
      
           
            
            // 查找该标题下的 evoldown 内容（#d, #e, #t, #c, #v, #a）
            $heading.nextUntil('h1, h2, h3, h4, h5, h6').each(function () {
                var $div = $(this);
                if ($div.hasClass('evoldown')) {
                    var type = $div.attr('type');
                    var id = $div.attr('id');
                    var label = $div.text(); // 假设需要从内容中提取 label
                    var icon = '';

                    // 根据类型插入相应的图标
                    switch (type) {
                        case 'd':
                            icon = '<svg type="d" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m21.15 6.85c0-2.2056-1.7944-4-4-4-4.1765-0.01989-5.4993 5.7322-1.8147 7.5629-0.263 0.63631-0.4627 1.4421-0.6559 2.2215-0.1397 0.56337-0.2841 1.1459-0.4405 1.6084-0.0728 0.2155-0.1286 0.4813-0.1891 0.4813-0.5072-0.7362-0.8126-2.2507-1.0979-3.3161-0.47879-1.5358-0.72936-4.4237-2.8018-4.558-0.77422 7e-5 -1.3844 0.52253-1.8138 1.553-0.55019 1.254-0.75064 3.2421-1.3784 4.4472-0.39648 3e-4 -0.79576 0.0045-1.1877 0.0703-0.67978 0.1073-1.3339 0.4195-1.798 0.9347-0.39707 0.4315-0.6427 0.9874-0.74275 1.5623-0.063545 0.351-0.07691 0.7094-0.07883 1.0654 0.001935 0.4718-0.01324 0.9457 0.027745 1.4163 0.09435 1.151 0.65732 2.1308 1.7281 2.6237 0.43467 0.1975 0.91053 0.2877 1.3854 0.3129 0.40096 0.0215 0.80345 0.0129 1.2048 0.0139 0.6491 2e-4 1.2891-0.0515 1.888-0.3229 0.90042-0.4067 1.4845-1.2039 1.6712-2.1666 0.0761-0.3779 0.09179-0.7654 0.09344-1.15 7.7e-4 -0.2699 0.00148-0.5413-7.8e-4 -0.8111-0.00379-0.4854-0.04143-0.9771-0.19121-1.4414-0.28748-0.9172-0.98053-1.616-1.8964-1.909 0.43984-1.1576 0.66815-2.7594 1.1268-3.8895 0.3537 0.72804 0.57113 1.7669 0.82283 2.7298 0.26567 1.0724 0.5404 2.1814 0.90896 3.0557 0.87204 2.2985 3.1124 2.7586 4.0452 0.392 0.5508-1.2642 0.7508-3.279 1.3828-4.4916 2.1142-0.10339 3.8024-1.8557 3.8024-3.995zm-12.073 8.8023c0.05605 0.2275 0.06623 0.465 0.07092 0.6983 0.00363 0.2444 0.00195 0.4906 0.00214 0.735-0.0063 0.408 0.01486 0.882-0.18359 1.2496-0.24573 0.4539-0.8026 0.501-1.2651 0.5114-0.33714 0.0058-0.67525 0.0041-1.0124 0.0018-0.46455-0.0092-1.0361-0.0245-1.3192-0.4545-0.16612-0.2552-0.19733-0.5702-0.21202-0.8673-0.01004-0.2443-0.00683-0.4906-0.0075-0.735 5.9e-4 -0.2322-0.00201-0.4664 0.01171-0.6983 0.01886-0.2936 0.06332-0.6069 0.24969-0.8453 0.34185-0.4331 1.0226-0.3889 1.5228-0.3979 0.38828 0.0035 0.77905-0.0131 1.1658 0.0285 0.49865 0.0566 0.85211 0.2621 0.97684 0.7737zm8.0732-6.8023c-2.6379-0.06696-2.6373-3.9334 0-4 2.6378 0.06697 2.6373 3.9334 0 4z" fill="currentColor"></path></svg>'; // 填入 #d 对应的 SVG 图标
                            break;
                        case 'e':
                            icon = '<svg type="e" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path fill="currentColor" d="m21.9 15.621c0.1248-1.8535-0.6087-3.4099-2.6058-3.8292-0.7712-0.15744-1.3921-0.13977-2.1113-0.14543-0.6323 0.0048-1.1718-0.01567-1.8401 0.03203 1.5356-0.8078 1.6998-2.205 1.6567-3.546 0.1272-2.3708-1.4685-3.666-3.7727-3.673-2.2427-0.04024-5.0463-0.27229-5.9443 1.9172-0.28083 0.6692-0.27606 1.2179-0.28202 1.6587-0.08527 1.4303 0.20687 2.9224 1.662 3.6429-2.3051-0.05275-5.3273-0.39212-6.28 1.8983-0.28073 0.66862-0.27595 1.2174-0.282 1.6572-0.10329 1.6061 0.3059 3.171 2.0252 3.8067 1.2061 0.4187 2.2175 0.2869 3.3945 0.3134 2.0524 0.0901 4.0448-0.4637 4.4796-2.4982 0.609 2.5638 3.2086 2.5463 5.3204 2.4982 2.7823 0.1278 4.7024-0.9368 4.5798-3.7329zm-12.899-7.6287c-0.14889-1.8665 1.8839-1.4921 3.1358-1.546 0.8939 0.05358 2.4743-0.21158 2.8003 0.88445 0.2729 2.4494-0.0297 2.8555-2.5242 2.8232-0.94713-0.07259-2.869 0.28949-3.3134-0.77077-0.14881-0.44557-0.08538-0.92893-0.09846-1.3909zm0.2606 9.2128c-0.56638 0.162-1.1652 0.1412-1.7487 0.1488-0.59786-0.0036-1.1977 0.0131-1.7948-0.0233-0.93407-0.0365-1.6776-0.3579-1.6157-1.4217 0.01574-0.5119-0.06845-1.0551 0.11822-1.5436 0.4432-0.84155 1.5978-0.6728 2.4032-0.7191 0.81712 0.01614 1.6464-0.05154 2.4536 0.10154 0.99382 0.17537 1.0564 0.91742 1.0227 1.7752-6.1e-4 0.7729 0.04085 1.416-0.83867 1.6821zm2.9212-3.6286c-0.0836 0.19457-0.14194 0.3848-0.18279 0.56614-0.18535-0.87758-0.76293-1.6189-1.5605-2.02 1.0871 0.04933 2.0387 0.04959 3.1216-8e-5 -0.7672 0.39034-1.1687 0.96486-1.3783 1.4539zm6.8788 3.6286c-0.5664 0.162-1.1652 0.1412-1.7488 0.1488-0.5978-0.0036-1.1977 0.0131-1.7947-0.0233-0.9341-0.0365-1.6776-0.3579-1.6157-1.4217 0.0157-0.5119-0.0685-1.0551 0.1182-1.5436 0.4432-0.84155 1.5978-0.6728 2.4033-0.7191 0.8171 0.01614 1.6464-0.05154 2.4536 0.10154 0.9938 0.17537 1.0563 0.91742 1.0227 1.7752-6e-4 0.7729 0.0409 1.416-0.8386 1.6821z"></path></svg>'; // 填入 #e 对应的 SVG 图标
                            break;
                        case 't':
                            icon = '<svg type="t" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m15.385 10.538c-0.52922 1.222-0.74082 3.1121-1.2852 4.3107-0.06906-2e-5 -0.24102-0.40954-0.40553-0.85764-0.54849-1.4968-0.91293-3.7816-1.4977-5.2179-0.49825-1.7178-2.7313-2.8836-3.8104-0.24557-0.55221 1.2498-0.75261 3.2793-1.3921 4.4683-0.45354 0.09492-0.79418 0.49706-0.79418 0.9788 0 0.5523 0.4477 1 1 1 0.77414 0 1.3844-0.52246 1.8137-1.5529 0.50969-1.1819 0.73444-2.9587 1.2241-4.138 0.07175 2e-5 0.14687 0.33291 0.23664 0.59492 0.20698 0.60425 0.39119 1.3477 0.58618 2.1349 0.2657 1.0724 0.54043 2.1814 0.90899 3.0557 0.87212 2.2985 3.1123 2.7586 4.0452 0.39202 0.55283-1.2608 0.75203-3.309 1.3936-4.5083 0.4522-0.0959 0.7915-0.49744 0.7915-0.97823 0-0.55229-0.4477-1-1-1-0.7755 0-1.3861 0.526-1.8148 1.5634z" fill="currentColor"></path><path d="m15.802 6.9697c-0.1557 0.1946-0.1882 0.58884 0.1331 0.60533 1.2616 0.02168 2.5193 0.48654 3.5913 1.2655 0.2705 0.19453 0.6808 0.05368 0.7176-0.30435 0.0793-0.76097 0.0572-1.5713-0.086-2.401-0.1456-0.82752-0.4109-1.6736-0.8018-2.5036-0.1536-0.34251-0.6624-0.55548-0.9204-0.23779l-0.7238 0.98277c-3.8989-2.9446-9.692-2.2836-12.827 1.4659-6.4518 7.8165 1.8281 18.818 11.123 14.783 1.8924-0.8564 3.4853-2.3528 4.4507-4.1927 0.0679-0.1218 0.1291-0.2481 0.1823-0.377 0.1017-0.2304 0.1549-0.518-0.0557-0.7052-0.1162-0.1043-0.2646-0.1628-0.4074-0.221-0.1475-0.0577-0.2953-0.116-0.4439-0.1706-0.2042-0.0713-0.4475-0.1531-0.6498-0.0358-0.0846 0.0496-0.1444 0.131-0.1982 0.2109-0.0747 0.1157-0.1266 0.2445-0.1952 0.3636-0.4837 0.9276-1.1717 1.74-1.9925 2.3831-0.8208 0.6431-1.7745 1.1169-2.7897 1.3673-7.0612 1.7198-12.182-6.5444-7.5021-12.107 2.4634-2.9539 7.0543-3.4782 10.119-1.154" fill="currentColor"></path></svg>'; // 填入 #t 对应的 SVG 图标
                            break;
                        case 'v':
                            icon = '<svg type="v" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m12.006 2.4861c8.295-0.034635 12.587 10.042 6.9396 15.995 0.302-0.0792 0.5884 0.106 0.8099 0.2931 0.1763 0.1517 0.337 0.3223 0.4938 0.4938 0.1806 0.1987 0.3602 0.3999 0.5393 0.6 0.158 0.1775 0.3162 0.3571 0.4573 0.5485 0.0932 0.127 0.1803 0.2635 0.2402 0.4098 0.0591 0.1432 0.0867 0.3066 0.0463 0.4586l-0.0182 0.058c-0.0546 0.1443-0.1606 0.2646-0.2695 0.3712-0.0972 0.0941-0.2013 0.1853-0.3018 0.2759-0.1104 0.0982-0.2212 0.201-0.3417 0.287-0.1188 0.0852-0.2583 0.1531-0.4066 0.159-0.2688 9e-3 -0.5043-0.1558-0.7006-0.3227-0.1407-0.1218-0.2719-0.2564-0.3983-0.3929-0.2101-0.2279-0.4164-0.4606-0.6233-0.6914-0.1578-0.1777-0.3167-0.3566-0.4572-0.5485-0.0869-0.1186-0.1682-0.2449-0.2272-0.3799-0.06-0.136-0.0946-0.2901-0.0688-0.4385l0.0117-0.0521 0.0161-0.0498c-1.7182 1.3134-3.966 2.0444-6.2474 1.9119-12.23-1.0527-11.717-18.608 0.50643-18.986zm-6.8e-4 2c-3.9794 3.5e-4 -7.2654 3.1166-7.4809 7.0946-0.30103 4.0208 3.0533 7.76 7.0834 7.8947 4.1153 0.2383 7.6845-2.9602 7.8946-7.0833 0.319-4.1746-3.3113-8.0014-7.4964-7.9059" fill="currentColor"></path><path d="m8.2769 7.8469c0.29326 0.69532 0.64074 1.1934 1.5 1.3397 0.4567-0.53241 1.0671-0.92645 1.7212-0.97652 0.65414-0.05007 1.1756 0.26304 1.2305 0.98096 0.10016 1.3082-2.47 2.532-1.899 4.9596 0.64656 0.38624 1.7475 0.36741 2.2073 0.03029-0.36861-2.09 2.575-3.1725 2.4052-5.3901-0.16975-2.2175-1.7734-3.0416-3.7676-2.8889-1.4358 0.10991-2.597 0.87279-3.3975 1.945z" fill="currentColor"></path><path d="m12.01 14.568c-0.99198 0-1.696 0.76802-1.696 1.7601 0 0.992 0.70406 1.776 1.696 1.776 0.97603 0 1.696-0.78404 1.696-1.776 0-0.99204-0.72002-1.7601-1.696-1.7601z" fill="currentColor"></path></svg>'; // 填入 #v 对应的 SVG 图标
                            break;
                        case 'a':
                            icon = '<svg type="a" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m15.45 7.35c-0.0022-1.4574-0.7043-2.0002-2.0001-2.0002-0.5281 0-1.0428 0.12066-1.6692 0.8986-1.2172 1.2052-3.5662 1.5773-6.4138 1.5566-0.92067 0.00495-1.8844 0.27586-2.521 0.97407-0.89662 0.97053-0.8534 2.1136-0.84541 3.3436-0.088935 2.0639 1.0163 3.5806 3.1554 3.6639 0.18073 0.9556 0.68251 3.671 0.86079 4.5885 0.11273 0.6047 0.44099 0.6361 0.97316 0.525 0.52124-0.1078 1.1127-0.1057 0.99809-0.819-0.14025-0.8342-0.63023-3.3751-0.78778-4.2434 2.2128 0.1862 3.6134 0.5907 4.5806 1.5138 0.63361 0.6782 1.2967 0.8987 1.6692 0.8987 1.2958-1e-4 2.0107-0.6194 2.0001-2.0002v-3.2681c0.2954-0.13425 0.725-0.23189 1.35-0.23189v-2c-0.625 0-1.0546-0.09763-1.35-0.23189v-3.1681zm-2 8.9q-1.45-2.45-7.4205-2.45c-1.4917 0.02186-2.072-0.06445-2.0295-1.7275 0.00524-1.5258-0.13158-2.3285 1.723-2.2725 5.5801 0.23384 7.964-2.492 7.727-2.45v8.9z" fill="currentColor"></path><path d="m22.024 11.62c0.00399-0.58801-0.05448-1.0153-0.74975-1.0361-0.41509-0.00662-0.82816 0.057395-1.2409 0.094325-0.33033 0.040455-0.73566 0.076976-1.0072 0.28268-0.28398 0.21724-0.23153 0.59429-0.23733 0.9112-0.0015854 0.30307-0.0045853 0.60983 0.27663 0.79666 0.23484 0.15349 0.52158 0.19534 0.7942 0.23343 0.23915 0.02956 0.48002 0.05101 0.71976 0.07523 0.48243 0.03148 1.2248 0.19557 1.394-0.41829 0.0757-0.30577 0.04467-0.627 0.05067-0.93912z" fill="currentColor"></path><path d="m17.348 5.7962c0.042171 0.25853 0.19707 0.48146 0.30883 0.71387 0.28865 0.62708 0.76754 0.52952 1.3216 0.33695 0.29707-0.1074 0.5898-0.22819 0.88354-0.34427 1.2431-0.47478 0.99431-0.8753 0.46485-1.8723-0.42612-0.90268-0.91649-0.67014-1.6207-0.2097-0.32028 0.21007-0.65168 0.40646-0.95187 0.64525-0.21815 0.17815-0.44959 0.42625-0.40623 0.73022z" fill="currentColor"></path><path d="m20.756 17.801c-0.08779-0.41834-0.59472-0.57-0.94009-0.72238-0.31748-0.12454-0.63252-0.2579-0.95618-0.36584-0.27393-0.083771-0.59373-0.17244-0.86319-0.031395-0.21247 0.11853-0.30992 0.35702-0.4191 0.56205-0.12688 0.25243-0.31107 0.53775-0.19892 0.82794 0.1101 0.27652 0.36419 0.46004 0.59732 0.62904 0.18414 0.12824 0.3747 0.24849 0.56281 0.37079 0.15333 0.0986 0.3065 0.19968 0.46418 0.29127 0.21755 0.12307 0.46707 0.25848 0.72501 0.21843 0.34543-0.06224 0.50617-0.44433 0.6571-0.72156 0.07714-0.15037 0.15704-0.30255 0.23064-0.4547 0.08692-0.18674 0.17446-0.39353 0.14043-0.60364z" fill="currentColor"></path></svg>'; // 填入 #a 对应的 SVG 图标
                            break;
                        case 'c':
                            icon = '<svg type="c" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" version="1.1" aria-hidden="true" class=""><path d="m6.825 4.8749c1.8175-0.03033 2.3249 0.02869 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9798-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.019-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40204 2.4713 0.42016 0.661-0.00557 1.2079 0.02014 1.9275-0.21866 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08948-0.54803 0.07327-0.95095 0.0762-1.3975-0.00196-0.42752 0.01114-0.8053-0.05632-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17686-7.9441e-4 -0.35349-2.3937e-4 -0.53038-7.7934e-4z" fill="currentColor"></path><path d="m17.075 8.6749c1.8175-0.03034 2.3249 0.02868 2.25 2.0152 0.01495 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04171-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.05882 1.6262 0.20933 2.9457 1.5713 3.7017 0.98593 0.49528 1.6843 0.40205 2.4713 0.42017 0.66099-0.00556 1.2079 0.02015 1.9275-0.21865 1.051-0.35295 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42839 0.0112-0.80698-0.05673-1.3089-0.24288-1.9391-1.9097-2.8158-3.663-2.7068-0.17688-7.9346e-4 -0.35351-2.388e-4 -0.5304-7.7896e-4z" fill="currentColor"></path><path d="m8.4749 15.525c1.8175-0.03033 2.3249 0.02868 2.25 2.0152 0.01496 1.139 0.01338 1.984-1.3875 1.9797-1.6108-0.01491-2.7285 0.30288-2.6124-1.796-0.01899-1.5193-0.04172-2.2697 1.7499-2.1989zm0-2c-2.5847-0.10689-3.8882 1.4181-3.7496 3.8782-0.058825 1.6262 0.20934 2.9456 1.5713 3.7018 0.98591 0.49526 1.6843 0.40203 2.4713 0.42016 0.66099-0.00557 1.2079 0.02014 1.9276-0.21866 1.051-0.35294 1.7794-1.2693 1.9533-2.3675 0.08949-0.54803 0.07328-0.95095 0.07621-1.3975-0.00197-0.42753 0.01113-0.80529-0.05633-1.306-0.24162-1.9408-1.9089-2.8188-3.6634-2.7097-0.17688-7.9346e-4 -0.35351-2.4262e-4 -0.5304-7.8736e-4z" fill="currentColor"></path></svg>'; // 填入 #c 对应的 SVG 图标
                            break;
                    }
                    // 创建 <span> 包裹图标和附加信息
                    var iconSpan = $('<span>', { class: 'icon' }).html(`
                        <a href="#${id}" class: 'toc-link evoldown_toc_link'>
                            ${icon}
                            <p name="label">${id}</p>
                        </a>
                    `);

                    // 创建 <ol> 容器，设置与标题相同的缩进
                    var tocIconList = $('<ol>', { 
                        class: 'toc-list evoldown ', 
                        type: type,
                    });
                    tocIconList.append(iconSpan);
                    // 将 <ol> 添加到当前 TOC 项
                    tocListItem.append(tocIconList);
                }
            });
            

            // 点击箭头切换展开/隐藏
            tocItemWrapper.find('.arrow-icon').click(function (e) {
                e.stopPropagation(); // 阻止事件冒泡
                var $arrow = $(this);
                var $parentDiv = $arrow.closest('.toc-item-wrapper'); // 获取箭头所在的父级 <div>
                var $nextLists =  $parentDiv.siblings('ol.toc-list'); // 获取与父级 <div> 同级的 <ol>

                // 判断箭头当前的旋转状态
                if ($arrow.css('transform') === 'matrix(1, 0, 0, 1, 0, 0)') { // rotate(0deg) 表示箭头指向下
                    // 隐藏逻辑
                    $arrow.css('transform', 'rotate(90deg)'); // 将箭头旋转为向左
                    $nextLists.css('display', 'none'); // 隐藏内容
                } else {
                    // 展开逻辑
                    $arrow.css('transform', 'rotate(0deg)'); // 将箭头旋转为向下
                    $nextLists.css('display', 'block'); // 显示内容
                }
            });

            // 将 <li> 添加到 <ol>
            // tocList.append(tocListItem);

            // 将 TOC 项添加到 TOC 容器
            $('#toc-content').append(tocList);


        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="/libs/prism/prism.js" defer></script>
<script src="https://cdn.bootcdn.net/ajax/libs/prism/1.9.0/plugins/line-numbers/prism-line-numbers.js" defer></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    
<footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="6638358192"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2025</span>
            
            <a href="/about" target="_blank">Hkini</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">124.6k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2022";
                        var startMonth = "12";
                        var startDate = "25";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
                <span id="icp"><img src="/medias/icp.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备2023000334号-1</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/togetherhkl" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:hekailin@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1778267485" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1778267485" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>





    <a href="https://www.zhihu.com/people/wei-lai-ke-qi-49-69" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/wei-lai-ke-qi-49-69" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="195339201" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
